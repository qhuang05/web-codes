<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>绘制图像</title>
  <link type="text/css" rel="stylesheet" href="css/reset.css" />
</head>

<body>
  <canvas id="canvas1" width="400" height="400" style="background: #ccc;"></canvas>

  <script>
    window.onload = function () {
      var canvas1 = document.getElementById('canvas1');
      var ctx1 = canvas1.getContext('2d');
      let image = new Image();
      image.src = "https://img2.baidu.com/it/u=2784663868,2334020525&fm=26&fmt=auto&gp=0.jpg"
      image.setAttribute("crossOrigin", "anonymous");
      image.onload = () => {
        // ctx1.save();
        // ctx1.rect(50,25,200,200);
        // ctx1.stroke();
        // ctx1.clip();
        // ctx1.fillStyle="green";
        // ctx1.fillRect(0,0,100,150);
        // ctx1.restore();

        // 备注: 以下方法一和方法二最终效果一样

        // 方法一: 使用canvas的transform
        // ctx1.save();
        // ctx1.rect(100, 50, 200, 200);
        // ctx1.stroke();
        // ctx1.clip();
        // ctx1.transform(1,0,0,1,100,50);
        // ctx1.transform(0.8,0,0,0.8,0,0);
        // ctx1.transform(Math.cos(30*Math.PI/180), Math.sin(30*Math.PI/180),-Math.sin(30*Math.PI/180), Math.cos(30*Math.PI/180), 0, 0);
        // // ctx1.setTransform(1,0,0,1,100,50); //setTransform会重置并创建新的变换矩阵
        // ctx1.drawImage(image, 0, 0, 200, 200);
        // ctx1.restore();

        // 方法二: 使用svg的createSVGMatrix方法创建矩阵
        ctx1.save();
        ctx1.rect(100, 50, 200, 200);
        ctx1.stroke();
        ctx1.clip();
        let svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        let svgMatrix = svg.createSVGMatrix();
        svgMatrix = svgMatrix.translate(100, 50);
        svgMatrix = svgMatrix.scale(0.8, 0.8);
        svgMatrix = svgMatrix.rotate(30);
        console.log('svgMatrix => ', svgMatrix)
        console.log('points => ', svgMatrix.a, svgMatrix.b, svgMatrix.c, svgMatrix.d, svgMatrix.e, svgMatrix.f);
        ctx1.transform(svgMatrix.a, svgMatrix.b, svgMatrix.c, svgMatrix.d, svgMatrix.e, svgMatrix.f);
        // ctx1.setTransform(svgMatrix);
        ctx1.drawImage(image, 0, 0, 200, 200);
        ctx1.restore();
      }
    }
  </script>
</body>

</html>
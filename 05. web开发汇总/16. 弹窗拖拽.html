<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <title>弹窗拖拽</title>
    <script src="plugins/jquery-1.11.3.min.js"></script>
    <style>
        *{margin:0;padding:0;}
        .popup{ 
            min-width: 300px;
            border: 1px solid #efefef;
            position: fixed; 
            top: 50%; 
            left: 50%; 
            -webkit-transform: translate(-50%, -50%);
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
        }
        .pop-header{ height: 30px; line-height: 30px; border-bottom:1px solid #efefef; padding: 0 20px;cursor:pointer;}
        .pop-footer{ height: 30px; line-height: 30px; border-top: 1px solid #efefef; padding: 0 20px;}
        .pop-body{ padding: 0 20px; }
    </style>
</head>
<body>
<div class="popup">
    <div class="pop-header">标题</div>
    <div class="pop-body">内容</div>
    <div class="pop-footer">底部</div>
</div>
<script type="text/javascript">
popupDragging();
function popupDragging(){
    var $popup, $target, winWidth, winHeight, popWidth, popHeight, maxX, maxY, targtX, targetY, mouseX, mouseY, mvflag = false;
    // (function(){
        $(document).on('mousedown', '.pop-header', function(e){
            $target = $(this);
            $popup = $(this).closest('.popup');
            winWidth = $(window).width();
            winHeight = $(window).height();
            popWidth = $popup.width();
            popHeight = $popup.height();
            maxX = winWidth - popWidth/2;
            maxY = winHeight - popHeight/2;
            targetX = parseInt($popup.css('left'));
            targetY = parseInt($popup.css('top'));
            mouseX = e.clientX - targetX;
            mouseY = e.clientY - targetY;
            mvflag = true;
            console.log(1);
        });
        $(document).on('mouseup', function(e){
            mvflag = false;
            console.log(2);
        });
        $(document).on('mousemove', function(e){
            if(mvflag){
                console.log(33);
                var left = e.clientX - mouseX,
                    top = e.clientY - mouseY;
                left = Math.max(left, popWidth/2);
                left = Math.min(left, maxX);
                top = Math.max(top, popHeight/2);
                top = Math.min(top, maxY);
                $popup.css({
                    left: left + 'px',
                    top: top + 'px'
                });
            }
        });
    // })(); 
}
</script>
</body>
</html>
